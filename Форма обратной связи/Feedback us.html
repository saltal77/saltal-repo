<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Форма обратной связи</title>
  <link href="css/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <link href="css/rcarousel.css" rel="stylesheet" type="text/css"/>
  <link href="css/feed.style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="container">
  <div id="carousel">
    <img src="images/001.png" />
    <img src="images/002.png" />
    <img src="images/003.png" />
    <img src="images/004.png" />
    <img src="images/005.png" />
    <img src="images/006.png" />
    <img src="images/007.png" />
  </div>
  <a href="#" id="ui-carousel-next"></a>
  <a href="#" id="ui-carousel-prev"></a>
</div>
<fieldset>
  <label>Город:</label><br/>
  <input id ="city" type="text"  placeholder = "Город"><br/>
  <label>Имя:</label><br/>
  <input id ='name' name ="name" type="text" class = "names" placeholder = "Имя"><br/>
  <label>Дата рождения:</label><br/>
  <input name ="date" type="text" id="datepicker" placeholder = 'дд.мм.гггг'><br/>
  <label>Телефон:</label><br/>
  <input id = 'tel' name ="tel" type="text" placeholder = "+7(000)000-0000"><br/>
  <label>e-mail:</label><br/>
  <input id = 'email' name ="email" type="text" placeholder = "mail@site.com"><br/>
  <label>Текст:</label><br/>
  <textarea id = 'textfld' rows="5" cols="15" name="text" placeholder = "Ваше сообщение..."></textarea><br/>
  <button id = 'send'>Отправить</button><br/>
</fieldset>
<div id = 'result'></div>
<script src="js/jquery.ui.widget.js"></script>
<script src="js/jquery.js"></script>
<script src="js/jquery-ui.js"></script>
<script src="js/jquery.ui.rcarousel.js"></script>
<script>
   //Автозаполнение поля Город из Json с помощью AJAX - jQueryUI autocomplete
    $(document).ready(function () {
        var towns = [];
        $.ajax({
            url: 'js/town.json',
            dataType : "json",
            success: function (data) {
                $.each(data, function(i, val) {
                    towns.push(val.town);
                    $('#city').autocomplete({
                        source: towns,
                        minChars: 3
                    });
                });
            }
        });
        //Виджет календарь JqueryUI datepicker
        $("#datepicker").datepicker({
            firstDay: 1,
            dayNamesMin: [ "Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб" ],
            monthNames: [ "Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь" ],
            dateFormat: "dd.mm.yy"
        });
       //Виджет Карусель на основе JqueryUI rcarousel
        $("#carousel ").rcarousel({
            margin: 10,
            visible: 4
        });
    });
  //Функция проверки формы
  document.getElementById('send').onclick = function () {
      //Регулярные выражения для проверки полей
      var regExpDate = /\d{2}\.\d{2}\.\d{4}/i;
      var regExpName = /([a-zA-Z]|[\D])/i;
      var regExpTel = /\+7\(\d{3}\)(\d{3}-\d{4})/i;
      var regExpEmail = /^([a-z0-9_-]+\.)*[a-z0-9_-]+@[a-z0-9_-]+(\.[a-z0-9_-]+)*\.[a-z]{2,6}$/i;
      var regExpText = /\w+|\D+/i;
      //Сбор данных из формы в переменные
      var data = document.querySelectorAll('fieldset input');
      var text = document.querySelector('fieldset textarea');
      //Сброс стиля поле ввода при каждой проверке
      data.forEach(function (item) {
         item.style.border = '';
      });
      text.style.border ='';
      //Функция вызывает эффект подпрыгивания неправильно заполненного поля input jQueryUI effect
      function inputEffects(id){
        $(id).effect('bounce', {}, 2000);
      }
      //Функция выводит результат проверки полей в блок div>#result
      //function printResult(text, d){
          //document.getElementById("result").innerHTML = text;
          //data[d].style.border = '1px dotted red';
      //}
      //Функция вывода сообщенией в окне о проверке полей  jQueryUI Dialog
      function dialogMessage(text, d){
          var $dialog_div = $('<p/>', {
              id: 'dialog',
              title: 'Не корректно заполнены поля',
              text: text
          });
          $($dialog_div).dialog({
              width:345,
              height:140
          });
          data[d].style.border = '1px dotted red';
      }
      //Проверка на правильное заполнение и вывод положительного результата об отправке
      if(regExpName.test(data[0].value) && regExpName.test(data[1].value)&& regExpDate.test(data[2].value) && regExpTel.test(data[3].value)&&
          regExpEmail.test(data[4].value)&& regExpText.test(text.value)){
          dialogMessage('Ваше сообщение отправлено');
      }
      //Блок условий & подсказок в случае не правильного заполнения
      else{
          if(!regExpName.test(data[0].value)){
              dialogMessage('Не выбран город', 0);
              inputEffects('#city');
          }
          if(!regExpName.test(data[1].value)){
              dialogMessage('Имя введено не верно', 1);
              inputEffects('#name');
          }
          if(!regExpDate.test(data[2].value)){
              dialogMessage('Не введена дата рождения', 2);
              inputEffects('#datepicker');
          }
          if(!regExpTel.test(data[3].value)){
              dialogMessage('Телефон введен не верно', 3);
              inputEffects('#tel');
          }
          if(!regExpEmail.test(data[4].value)){
              dialogMessage('Почта введена не верно', 4);
              inputEffects('#email');
          }
          if(!regExpText.test(text.value)){
              document.querySelector('fieldset textarea').style.border = '1px dotted red';
              inputEffects('#textfld');
              dialogMessage('Не введен текст');
            }
        }
    }
</script>
</body>
</html>